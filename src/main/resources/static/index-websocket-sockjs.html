<html>
	<head>
		<!--<script src="https://cdn.socket.io/4.6.0/socket.io.min.js"></script>-->
		
		<script src="https://cdn.jsdelivr.net/npm/sockjs-client@1/dist/sockjs.min.js"></script>
		<script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
	</head>
	
	<body>
		<label for="message-input">Enter your message</label>
        <input type="text" class="form-control" id="message-input">
        <button type="submit" onclick="sendMessage()">Send</button>
        <ul id="message-list"></ul>

		<script>
			//const socket = new WebSocket("ws://localhost:8080/myHandler");
			var sockjs = new SockJS('http://localhost:8080/websocket-sockjs');
			
			
			sockjs.onmessage = event => {
				console.log("Message received by sockjs:" + event.data);
				$('#message-list').append("<li>" + event.data + "</li>");
			}
			
			
			function sendMessage(){
				let input = document.getElementById('message-input');
			    sockjs.send(JSON.stringify({ message: input.value }));
			}
			
			sockjs.onclose = () => {
				console.log("Detected connection sockjs closed. Retrying reconnect")
				/*window.setInterval (() => {
					sockjs = new SockJS('http://localhost:8080/websocket-sockjs');
			
			
					sockjs.onmessage = event => {
						console.log("Message received by websocket:" + event.data);
						$('#message-list').append("<li>" + event.data + "</li>");
					}
				}, 5000)*/
			};
			
			
		</script>
	</body>
</html>